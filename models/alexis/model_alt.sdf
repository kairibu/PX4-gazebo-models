<?xml version="1.0" ?>
<sdf version="1.10">
    <model name='alexis' canonical_link='fuselage'>
        <pose>0 0 0 0 0 0</pose>
        <link name='fuselage'>
            <pose relative_to='__model__'>0.5 0 0.4 0 0 0</pose>
            <collision name='fuselage_collision'>
                <pose>0 0 0 0 0 0</pose>
                <geometry>
                <box>
                    <size>1.7 1 0.3</size>
                </box>
                </geometry>
                <surface>
                    <contact>
                        <ode>
                        <max_vel>10</max_vel>
                        <min_depth>0.01</min_depth>
                        </ode>
                    </contact>
                </surface>
            </collision>
            <collision name='wings_collision'>
                <pose>0.6 -0.5 0.07 0 0 0</pose>
                <geometry>
                <box>
                    <size>0.5 2.0 0.2</size>
                </box>
                </geometry>
                <surface>
                <contact>
                    <ode>
                    <max_vel>10</max_vel>
                    <min_depth>0.01</min_depth>
                    </ode>
                </contact>
                </surface>
            </collision>
            <inertial> <!--inertial properties of the link mass, inertia matix-->
                <mass>1.14395</mass>
                <inertia>
                <ixx>0.095329</ixx>
                <ixy>0</ixy>
                <ixz>0</ixz>
                <iyy>0.381317</iyy>
                <iyz>0</iyz>
                <izz>0.476646</izz>
                </inertia>
            </inertial>
            <visual name='visual'>
                <geometry>
                    <mesh>
                        <scale>1 1 1</scale>
                        <uri>./meshes/alexis.dae</uri>
                    </mesh>
                </geometry>
                <!--let's add color to our link-->
                <material>
                <ambient>0 0 1.0 1</ambient>
                <diffuse>0.1 0.1 0.8 1</diffuse>
                <specular>0.1 0.1 0.6 1</specular>
                </material>
            </visual>
            <sensor name="magnetometer_sensor" type="magnetometer">
                <always_on>1</always_on>
                <update_rate>100</update_rate>
                <magnetometer>
                <!-- TODO: update to fix units and coordinate system when we move past Harmonic -->
                <!-- See https://github.com/gazebosim/gz-sim/pull/2460 -->
                <!-- 3mgauss RMS: NOTE: noise is in tesla but sensor reports data in gauss -->
                <!-- Noise modeled after IIS2MDC -->
                <x>
                    <noise type="gaussian">
                    <stddev>0.0001</stddev>
                    </noise>
                </x>
                <y>
                    <noise type="gaussian">
                    <stddev>0.0001</stddev>
                    </noise>
                </y>
                <z>
                    <noise type="gaussian">
                    <stddev>0.0001</stddev>
                    </noise>
                </z>
                </magnetometer>
            </sensor>
            <sensor name="imu_sensor" type="imu">
                <always_on>1</always_on>
                <update_rate>250</update_rate>
                <imu>
                <angular_velocity>
                    <x>
                    <noise type="gaussian">
                        <mean>0</mean>
                        <stddev>0.0003394</stddev>
                        <dynamic_bias_stddev>3.8785e-05</dynamic_bias_stddev>
                        <dynamic_bias_correlation_time>1000</dynamic_bias_correlation_time>
                    </noise>
                    </x>
                    <y>
                    <noise type="gaussian">
                        <mean>0</mean>
                        <stddev>0.0003394</stddev>
                        <dynamic_bias_stddev>3.8785e-05</dynamic_bias_stddev>
                        <dynamic_bias_correlation_time>1000</dynamic_bias_correlation_time>
                    </noise>
                    </y>
                    <z>
                    <noise type="gaussian">
                        <mean>0</mean>
                        <stddev>0.0003394</stddev>
                        <dynamic_bias_stddev>3.8785e-05</dynamic_bias_stddev>
                        <dynamic_bias_correlation_time>1000</dynamic_bias_correlation_time>
                    </noise>
                    </z>
                </angular_velocity>
                <linear_acceleration>
                    <x>
                    <noise type="gaussian">
                        <mean>0</mean>
                        <stddev>0.004</stddev>
                        <dynamic_bias_stddev>0.006</dynamic_bias_stddev>
                        <dynamic_bias_correlation_time>300</dynamic_bias_correlation_time>
                    </noise>
                    </x>
                    <y>
                    <noise type="gaussian">
                        <mean>0</mean>
                        <stddev>0.004</stddev>
                        <dynamic_bias_stddev>0.006</dynamic_bias_stddev>
                        <dynamic_bias_correlation_time>300</dynamic_bias_correlation_time>
                    </noise>
                    </y>
                    <z>
                    <noise type="gaussian">
                        <mean>0</mean>
                        <stddev>0.004</stddev>
                        <dynamic_bias_stddev>0.006</dynamic_bias_stddev>
                        <dynamic_bias_correlation_time>300</dynamic_bias_correlation_time>
                    </noise>
                    </z>
                </linear_acceleration>
                </imu>
            </sensor>
        </link>
        <link name="left_aileron">
            <inertial>
                <mass>0.00000001</mass>
                <inertia>
                <ixx>0.000001</ixx>
                <ixy>0.0</ixy>
                <iyy>0.000001</iyy>
                <ixz>0.0</ixz>
                <iyz>0.0</iyz>
                <izz>0.000001</izz>
                </inertia>
                <pose>0 -0.3 0 0.00 0 0.0</pose>
            </inertial>
            <visual name='left_aileron_visual'>
                <pose relative_to="fuselage">0.6 -0.6 0.152 0.00 0 0.0</pose>
                <geometry>
                    <box>
                        <size>0.06 0.5 0.02</size>
                    </box>
                </geometry>
                <material>
                    <ambient>1 0 0 1.0</ambient>
                    <diffuse>1 0 0 1.0</diffuse>
                </material>
            </visual>
        </link>
        <link name="right_aileron">
            <inertial>
                <mass>0.00000001</mass>
                <inertia>
                <ixx>0.000001</ixx>
                <ixy>0.0</ixy>
                <iyy>0.000001</iyy>
                <ixz>0.0</ixz>
                <iyz>0.0</iyz>
                <izz>0.000001</izz>
                </inertia>
                <pose>0 0.3 0 0.00 0 0.0</pose>
            </inertial>
            <visual name='right_aileron_visual'>
                <pose relative_to="fuselage">0.6 0.6 0.152 0.00 0 0.0</pose>
                <geometry>
                    <box>
                        <size>0.06 0.5 0.02</size>
                    </box>
                </geometry>
                <material>
                    <ambient>1 0 0 1.0</ambient>
                    <diffuse>1 0 0 1.0</diffuse>
                </material>
            </visual>
        </link>
        <link name="left_rudder">
            <inertial>
                <mass>0.00000001</mass>
                <inertia>
                <ixx>0.000001</ixx>
                <ixy>0.0</ixy>
                <iyy>0.000001</iyy>
                <ixz>0.0</ixz>
                <iyz>0.0</iyz>
                <izz>0.000001</izz>
                </inertia>
                <pose>0 0.3 0 0.00 0 0.0</pose>
            </inertial>
            <visual name='left_rudder_visual'>
                <pose relative_to="fuselage">1.6 0.15 0.2 -0.55 0 0.0</pose>
                <geometry>
                    <box>
                        <size>0.06 0.22 0.02</size>
                    </box>
                </geometry>
                <material>
                    <ambient>1 0 0 1.0</ambient>
                    <diffuse>1 0 0 1.0</diffuse>
                </material>
            </visual>
        </link>
        <link name="right_rudder">
            <inertial>
                <mass>0.00000001</mass>
                <inertia>
                <ixx>0.000001</ixx>
                <ixy>0.0</ixy>
                <iyy>0.000001</iyy>
                <ixz>0.0</ixz>
                <iyz>0.0</iyz>
                <izz>0.000001</izz>
                </inertia>
                <pose>0 0.3 0 0.00 0 0.0</pose>
            </inertial>
            <visual name='right_rudder_visual'>
                <pose relative_to="fuselage">1.6 -0.15 0.2 0.55 0 0.0</pose>
                <geometry>
                    <box>
                        <size>0.06 0.22 0.02</size>
                    </box>
                </geometry>
                <material>
                    <ambient>1 0 0 1.0</ambient>
                    <diffuse>1 0 0 1.0</diffuse>
                </material>
            </visual>
        </link>

        <link name='rotor_puller'>
            <pose>0.22 0 0.0 0 1.57079632679 0</pose>

            <collision name='rotor_puller_collision'>
                <pose>0 0 0 0 -1.57079632679 0</pose>
                <geometry>
                <box>
                    <size>0.005 0.22 0.02</size>
                </box>
                </geometry>
                <surface>
                <contact>
                    <ode/>
                </contact>
                <friction>
                    <ode/>
                </friction>
                </surface>
            </collision>
            <!-- <visual name='rotor_puller_collision_visual'>
                <pose>0 0 0 0 -1.57079632679 0</pose>
                <geometry>
                <box>
                    <size>0.005 0.22 0.02</size>
                </box>
                </geometry>
            </visual> -->
            <visual name='rotor_puller_visual'>
                <pose relative_to="fuselage">0.67 0 0.14 0 1.57079633 0</pose>
                <geometry>
                <mesh>
                    <scale>1.4 1.4 1.4</scale>
                    <uri>./meshes/iris_prop_ccw.dae</uri>
                </mesh>
                </geometry>
                <material>
                <ambient>0 0 1 1.0</ambient>
                <diffuse>0 0 1 1.0</diffuse>
                </material>
            </visual>
            <gravity>0</gravity>
            <velocity_decay/>
            <self_collide>0</self_collide>
        </link>

        <joint name='rotor_puller_joint' type='revolute'>
            <child>rotor_puller</child>
            <parent>fuselage</parent>
            <axis>
                <xyz>0 0 1</xyz>
                <limit>
                    <lower>-1e+16</lower>
                    <upper>1e+16</upper>
                </limit>
                <dynamics>
                    <spring_reference>0</spring_reference>
                    <spring_stiffness>0</spring_stiffness>
                </dynamics>
            </axis>
        </joint>

        <joint name='servo_0' type='revolute'>
            <parent>fuselage</parent>
            <child>left_aileron</child>
            <pose relative_to="fuselage">0.6 -0.6 0.152 0.00 0 0.0</pose>
            <axis>
                <xyz>0 1 0</xyz>
                <limit>
                    <lower>-0.78</lower>
                    <upper>0.78</upper>
                </limit>
                <dynamics>
                    <damping>1.000</damping>
                </dynamics>
            </axis>
            <physics>
                <ode>
                <implicit_spring_damper>1</implicit_spring_damper>
                </ode>
            </physics>
        </joint>

        <joint name='servo_1' type='revolute'>
            <parent>fuselage</parent>
            <child>right_aileron</child>
            <pose relative_to="fuselage">0.6 0.6 0.152 0.00 0 0.0</pose>
            <axis>
                <xyz>0 1 0</xyz>
                <limit>
                    <lower>-0.78</lower>
                    <upper>0.78</upper>
                </limit>
                <dynamics>
                    <damping>1.000</damping>
                </dynamics>
            </axis>
            <physics>
                <ode>
                <implicit_spring_damper>1</implicit_spring_damper>
                </ode>
            </physics>
        </joint>

        <plugin filename="gz-sim-joint-position-controller-system" name="gz::sim::systems::JointPositionController">
            <joint_name>servo_0</joint_name>
            <sub_topic>servo_0</sub_topic>
            <p_gain>10.0</p_gain>
        </plugin>

        <plugin filename="gz-sim-joint-position-controller-system" name="gz::sim::systems::JointPositionController">
            <joint_name>servo_1</joint_name>
            <sub_topic>servo_1</sub_topic>
            <p_gain>10.0</p_gain>
        </plugin>

    </model>
</sdf>
